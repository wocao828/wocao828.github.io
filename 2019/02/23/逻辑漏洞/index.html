<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="yes" name="apple-touch-fullscreen"><meta content="telephone=no,email=no" name="format-detection"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"><link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"><link href="https://fonts.googleapis.com/css?family=Rubik" rel="stylesheet"><script src="https://use.fontawesome.com/adaf0e149c.js"></script><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/monokai_sublime.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/post.css"><link rel="stylesheet" href="/css/markdown-github.css"><title>zhang's blog</title><script src="/js/googleAnalytics.js"></script></head><body><div id="postContainer"><div id="postTop"><h4 id="logo">Life Is Short</h4><br><br><h2 id="postTitle">逻辑漏洞</h2><br><span aria-hidden="true" class="postTime fa fa-calendar">2019-2-23</span><br><br></div><section id="articleDiv"><p>前言:现在的常规漏洞已经越来越少了，而逻辑漏洞却越来越多了，本次来了解一些常见的逻辑漏洞</p><br><h3 id="一-身份认证安全"><a href="#一-身份认证安全" class="headerlink" title="一 身份认证安全"></a>一 身份认证安全</h3><h4 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h4><h4 id="撞库"><a href="#撞库" class="headerlink" title="撞库"></a>撞库</h4><h4 id="针对cookie"><a href="#针对cookie" class="headerlink" title="针对cookie"></a>针对cookie</h4><h4 id="针对session"><a href="#针对session" class="headerlink" title="针对session"></a>针对session</h4><h4 id="加密测试"><a href="#加密测试" class="headerlink" title="加密测试"></a>加密测试</h4><h3 id="二-业务一致性安全"><a href="#二-业务一致性安全" class="headerlink" title="二 业务一致性安全"></a>二 业务一致性安全</h3><h4 id="1-邮箱更改"><a href="#1-邮箱更改" class="headerlink" title="1.邮箱更改"></a>1.邮箱更改</h4><h4 id="2-订单ID更改"><a href="#2-订单ID更改" class="headerlink" title="2.订单ID更改"></a>2.订单ID更改</h4><h4 id="3-商品编号更改"><a href="#3-商品编号更改" class="headerlink" title="3.商品编号更改"></a>3.商品编号更改</h4><h4 id="4-用户ID更改"><a href="#4-用户ID更改" class="headerlink" title="4.用户ID更改"></a>4.用户ID更改</h4><h4 id="5-手机号篡改"><a href="#5-手机号篡改" class="headerlink" title="5.手机号篡改"></a>5.手机号篡改</h4><h3 id="三-业务数据篡改"><a href="#三-业务数据篡改" class="headerlink" title="三 业务数据篡改"></a>三 业务数据篡改</h3><h4 id="1-金融数据篡改"><a href="#1-金融数据篡改" class="headerlink" title="1.金融数据篡改"></a>1.金融数据篡改</h4><h4 id="2-商品数量篡改"><a href="#2-商品数量篡改" class="headerlink" title="2.商品数量篡改"></a>2.商品数量篡改</h4><h4 id="3-本地js参数修改"><a href="#3-本地js参数修改" class="headerlink" title="3.本地js参数修改"></a>3.本地js参数修改</h4><h3 id="四-用户输入合规性"><a href="#四-用户输入合规性" class="headerlink" title="四 用户输入合规性"></a>四 用户输入合规性</h3><h4 id="1-注入"><a href="#1-注入" class="headerlink" title="1.注入"></a>1.注入</h4><h4 id="2-xss"><a href="#2-xss" class="headerlink" title="2.xss"></a>2.xss</h4><h4 id="3-csrf"><a href="#3-csrf" class="headerlink" title="3.csrf"></a>3.csrf</h4><h4 id="4-文件上传"><a href="#4-文件上传" class="headerlink" title="4.文件上传"></a>4.文件上传</h4><h4 id="5-文件包含"><a href="#5-文件包含" class="headerlink" title="5.文件包含"></a>5.文件包含</h4><h4 id="6-xxe"><a href="#6-xxe" class="headerlink" title="6.xxe"></a>6.xxe</h4><h4 id="7-ssrf"><a href="#7-ssrf" class="headerlink" title="7.ssrf"></a>7.ssrf</h4><h3 id="五-密码找回逻辑漏洞"><a href="#五-密码找回逻辑漏洞" class="headerlink" title="五 密码找回逻辑漏洞"></a>五 密码找回逻辑漏洞</h3><h4 id="挖掘流程"><a href="#挖掘流程" class="headerlink" title="挖掘流程"></a>挖掘流程</h4><p>1.首先走一遍正常密码修改流程，把过程中的数据包全都保存</p><br><p>2.分析流程中哪些步骤使用了哪些身份认证信息，使用了哪些认证方法</p><br><p>3.分析那个步骤可以跳过，或者直接访问某个步骤</p><br><p>4.分析每个认证方法是否有缺陷，可否越权</p><br><p>5.尝试正常密码找回流程</p><br><p>6.分析找回机制所采用的验证手段，如验证码的有效期，有效次数等</p><br><p>7.抓取修改步骤中所有的数据包，尝试修改关键信息，如用户名等<br><img src="/2019/02/23/逻辑漏洞/1.png" alt="1"></p><br><h4 id="1-用户凭证暴力破解"><a href="#1-用户凭证暴力破解" class="headerlink" title="1.用户凭证暴力破解"></a>1.用户凭证暴力破解</h4><h4 id="2-直接返回凭证"><a href="#2-直接返回凭证" class="headerlink" title="2.直接返回凭证"></a>2.直接返回凭证</h4><h4 id="3-邮箱弱token"><a href="#3-邮箱弱token" class="headerlink" title="3.邮箱弱token"></a>3.邮箱弱token</h4><h4 id="4-用户凭证有效性"><a href="#4-用户凭证有效性" class="headerlink" title="4.用户凭证有效性"></a>4.用户凭证有效性</h4><h3 id="六-验证码突破"><a href="#六-验证码突破" class="headerlink" title="六 验证码突破"></a>六 验证码突破</h3><h4 id="1-前端验证"><a href="#1-前端验证" class="headerlink" title="1.前端验证"></a>1.前端验证</h4><h4 id="2-session存储验证码验证记录"><a href="#2-session存储验证码验证记录" class="headerlink" title="2.session存储验证码验证记录"></a>2.session存储验证码验证记录</h4><h4 id="3-验证码不变"><a href="#3-验证码不变" class="headerlink" title="3.验证码不变"></a>3.验证码不变</h4><h4 id="4-验证码自动识别"><a href="#4-验证码自动识别" class="headerlink" title="4.验证码自动识别"></a>4.验证码自动识别</h4><h3 id="七-业务授权安全"><a href="#七-业务授权安全" class="headerlink" title="七 业务授权安全"></a>七 业务授权安全</h3><h4 id="未授权访问"><a href="#未授权访问" class="headerlink" title="未授权访问"></a>未授权访问</h4><h3 id="八-业务流程乱序"><a href="#八-业务流程乱序" class="headerlink" title="八 业务流程乱序"></a>八 业务流程乱序</h3><h3 id="九-业务接口调用"><a href="#九-业务接口调用" class="headerlink" title="九 业务接口调用"></a>九 业务接口调用</h3><h4 id="1-短信轰炸"><a href="#1-短信轰炸" class="headerlink" title="1.短信轰炸"></a>1.短信轰炸</h4><h4 id="2-内容编辑"><a href="#2-内容编辑" class="headerlink" title="2.内容编辑"></a>2.内容编辑</h4><h3 id="十-时效性绕过"><a href="#十-时效性绕过" class="headerlink" title="十 时效性绕过"></a>十 时效性绕过</h3><h4 id="1-时间刷新缺陷"><a href="#1-时间刷新缺陷" class="headerlink" title="1.时间刷新缺陷"></a>1.时间刷新缺陷</h4><h4 id="2-时间范围测试"><a href="#2-时间范围测试" class="headerlink" title="2.时间范围测试"></a>2.时间范围测试</h4><h3 id="十一-其他逻辑漏洞"><a href="#十一-其他逻辑漏洞" class="headerlink" title="十一 其他逻辑漏洞"></a>十一 其他逻辑漏洞</h3><h2 id="逻辑漏洞挖掘关键点图"><a href="#逻辑漏洞挖掘关键点图" class="headerlink" title="逻辑漏洞挖掘关键点图"></a>逻辑漏洞挖掘关键点图</h2><p><img src="/2019/02/23/逻辑漏洞/1.jpg" alt="1"></p><br><h3 id="关于网站xxx的验证码漏洞"><a href="#关于网站xxx的验证码漏洞" class="headerlink" title="关于网站xxx的验证码漏洞"></a>关于网站xxx的验证码漏洞</h3><p>1.打开登陆界面<br><img src="/2019/02/23/逻辑漏洞/2.png" alt="2"><br>2.发现找回密码功能<br><img src="/2019/02/23/逻辑漏洞/3.png" alt="3"><br>3.发送一次正常请求<br><img src="/2019/02/23/逻辑漏洞/4.png" alt="4"><br><img src="/2019/02/23/逻辑漏洞/5.png" alt="5"><br>4.更换账户，发现账户不存在<br><img src="/2019/02/23/逻辑漏洞/6.png" alt="6"><br>5.在网站首页发现账户<br><img src="/2019/02/23/逻辑漏洞/7.png" alt="7"><br>6.随机登陆密码错误<br><img src="/2019/02/23/逻辑漏洞/8.png" alt="8"><br>7.使用burp开始爆破验证码<br><img src="/2019/02/23/逻辑漏洞/9.png" alt="9"><br><img src="/2019/02/23/逻辑漏洞/10.png" alt="10"><br>8.设置足够的线程数<br><img src="/2019/02/23/逻辑漏洞/11.png" alt="11"><br>9.成功爆破出验证码<br><img src="/2019/02/23/逻辑漏洞/13.png" alt="13"><br>10.使用修改成功的密码登陆后台<br><img src="/2019/02/23/逻辑漏洞/14.png" alt="14"></p>
</section></div><script src="/js/jquery.min.js"></script><script src="/js/highlight.min.js"></script><script src="/js/start.js"></script></body></html>