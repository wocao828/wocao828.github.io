<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="yes" name="apple-touch-fullscreen"><meta content="telephone=no,email=no" name="format-detection"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"><link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"><link href="https://fonts.googleapis.com/css?family=Rubik" rel="stylesheet"><script src="https://use.fontawesome.com/adaf0e149c.js"></script><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/monokai_sublime.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/post.css"><link rel="stylesheet" href="/css/markdown-github.css"><title>zhang's blog</title><script src="/js/googleAnalytics.js"></script></head><body><div id="postContainer"><div id="postTop"><h4 id="logo">Life Is Short</h4><br><br><h2 id="postTitle">新手搭建vpn</h2><br><span aria-hidden="true" class="postTime fa fa-calendar">2018-12-30</span><br><br></div><section id="articleDiv"><p>前言:如何搭建vpn，本篇将具体阐述</p><br><h2 id="Windows服务器上搭建"><a href="#Windows服务器上搭建" class="headerlink" title="Windows服务器上搭建"></a>Windows服务器上搭建</h2><p>1.打开服务管理器—&gt;添加角色—-&gt;勾选“网络策略和访问服务 ”——&gt;下一步—–&gt;勾选”路由和远程访问服务”—&gt;开始安装</p><br><p>2.角色中出现了“路由和远程访问”，现在是红色的，右键选择配置它，打开向导—&gt;选择自定义配置–&gt;服务里全选–&gt;完成–&gt;变成绿色</p><br><p>3.新增一个接口：ipv4–&gt;NAT—&gt;新建一个接口–&gt;选择要使用的网卡—&gt;接口类型选择“公用接口连接到Internet”,勾选“在此接口上启用NAT“</p><br><p>4.开始菜单–&gt;管理工具–&gt;网络策略服务器–&gt;策略–&gt;网络策略–&gt;把里面的两项被组织的属性改成“授予访问权限”</p><br><p>5.服务器管理器–&gt;配置–&gt;本地用户和组–&gt;添加一个用户–&gt;填写用户名、密码、勾选“用户不能更改密码”和“密码永不过期”，去掉“下次登陆须更改密码”的勾，点创建。</p><br><p>6.开始菜单–&gt;管理工具–&gt;本地安全策略–&gt;本地策略–&gt;用户权限分配–&gt;拒绝本地登陆，添加vpn用户—&gt;拒绝通过远程桌面登陆,添加vpn用户。</p><br><p>7.连接VPN：在客户机创建一个新连接–&gt;选择连接到工作区—&gt;使用我的internet连接–&gt;填写ip地址–&gt;填写之前创建的VPN用户名和密码–&gt;连接即可</p><br><h2 id="linux服务器上搭建vpn-本次实验使用ubuntu16-04"><a href="#linux服务器上搭建vpn-本次实验使用ubuntu16-04" class="headerlink" title="linux服务器上搭建vpn(本次实验使用ubuntu16.04)"></a>linux服务器上搭建vpn(本次实验使用ubuntu16.04)</h2><h3 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h3><p>1.检查更新<br>sudo apt-get update</p><br><p>2.输入命令<br>sudo apt-get install \</p><br><p>apt-transport-https \</p><br><p>ca-certificates \</p><br><p>curl \</p><br><p>software-properties-common</p><br><p>3.curl -fsSL <a href="https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg" target="_blank" rel="noopener">https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg</a> | sudo apt-key add -</p><br><p>4.sudo add-apt-repository \</p><br><p>“deb [arch=amd64] <a href="https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu" target="_blank" rel="noopener">https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu</a> \</p><br><p>$(lsb_release -cs) \</p><br><p>stable”</p><br><p>5.sudo apt-get update</p><br><p>6.sudo apt-get install docker-ce</p><br><p>7.vim /etc/docker/daemon.json<br>写入{<br>        “registry-mirrors”: [“<a href="https://registry.docker-cn.com&quot;]" target="_blank" rel="noopener">https://registry.docker-cn.com&quot;]</a><br>    }</p><br><p>8.重启docker<br>service docker restart</p><br><h3 id="搭建PPTP模式vpn"><a href="#搭建PPTP模式vpn" class="headerlink" title="搭建PPTP模式vpn"></a>搭建PPTP模式vpn</h3><p>1.用docker拉镜像<br>docker pull mobtitude/vpn-pptp</p><br><p>2.新建chap-secrets，写入</p><br><p>uname     <em>     upass    </em></p><br><p>3.运行docker</p><br><p>docker run -d –privileged –net host -v /root/chap-secrets:/etc/ppp/chap-secrets mobtitude/vpn-pptp</p><br><h3 id="搭建L2TP模式"><a href="#搭建L2TP模式" class="headerlink" title="搭建L2TP模式"></a>搭建L2TP模式</h3><p>1.用docker拉镜像<br>docker pull hwdsl2/ipsec-vpn-server</p><br><p>2.modprobe af_key</p><br><p>3.编辑vpn.env</p><br><p>写入VPN_IPSEC_PSK=qwerdf</p><br><p>VPN_USER=vpnuser</p><br><p>VPN_PASSWORD=vpnpassword</p><br><p>docker run –name vpn-docker –privileged –env-file /root/vpn.env -p 500:500/udp -p 4500:4500/udp -v /lib/modules:/lib/modules:ro  -d –privileged hwdsl2/ipsec-vpn-server</p><br><h3 id="shadowsocks"><a href="#shadowsocks" class="headerlink" title="shadowsocks"></a>shadowsocks</h3><p>1.下载shadowsocks</p><br><p>apt install shadowsocks -y</p><br><p>2.修改配置文件/etc/shadowsocks/config.json</p><br><p>vim /etc/shadowsocks/config.json</p><br><p>{<br>    “server”:”0.0.0.0”,</p><br><p>  “server_port”:8888,</p><br><p>“local_address”: “127.0.0.1”,</p><br><p> “local_port”:1080,</p><br><p> “password”:”123456”,</p><br><p>“timeout”:300,</p><br><p> “method”:”aes-256-cfb”,</p><br><p> “fast_open”: false,</p><br><p>  “workers”: 1,</p><br><p> “prefer_ipv6”: false</p><br><p>}</p><br><p>3.service shadowsocks restart</p><br><p>4.客户端连接</p>
</section></div><script src="/js/jquery.min.js"></script><script src="/js/highlight.min.js"></script><script src="/js/start.js"></script></body></html>